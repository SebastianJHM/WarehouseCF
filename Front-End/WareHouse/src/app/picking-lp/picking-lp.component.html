
<!---------------------------------Archivo Vector-------------------------------------------->
<br>
<div class="principal-title">
  <span>Picking Problem </span>
  <img height="35" src="./assets/picking.svg">
</div>

<!------------------Título------------------------->
<label class="input_file">
  <input type="file" onclick="this.value = null" (change) ="inputFile($event.target.files)"  accept=".xls, .xlsx" value="">

  <div class="title">
    <span class="title_text">Excel Data File</span>
    <img class="image" src="./assets/paperclip.svg">
  </div>
</label>
<!------------------------------------------------->



<!--------------------------Drag Box(Área de Archivos)-------------------------------->
<div class="ngx">
  <ngx-file-drop dropZoneLabel="Drop files here" (onFileDrop)="droppedFile($event)"
  (onFileOver)="fileOver($event)" (onFileLeave)="fileLeave($event)" accept="xls, xlsx" dropZoneClassName="tyu">

    <ng-template  ngx-file-drop-content-tmp let-openFileSelector="openFileSelector">


      <!--Si no se ha arrastrado ningún archivo muestra mensaje por defecto-->
      <div *ngIf="!ExcelFilePicking; else empty"  id="ngx-text">
          <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 438.533 438.533" style="enable-background:new 0 0 438.533 438.533;" xml:space="preserve"><g transform="matrix(1 0 0 1 0 0)"><g>
            <g>
              <path d="M409.133,109.203c-19.608-33.592-46.205-60.189-79.798-79.796C295.736,9.801,259.058,0,219.273,0    c-39.781,0-76.47,9.801-110.063,29.407c-33.595,19.604-60.192,46.201-79.8,79.796C9.801,142.8,0,179.489,0,219.267    c0,39.78,9.804,76.463,29.407,110.062c19.607,33.592,46.204,60.189,79.799,79.798c33.597,19.605,70.283,29.407,110.063,29.407    s76.47-9.802,110.065-29.407c33.593-19.602,60.189-46.206,79.795-79.798c19.603-33.596,29.403-70.284,29.403-110.062    C438.533,179.485,428.732,142.795,409.133,109.203z M353.742,297.208c-13.894,23.791-32.736,42.633-56.527,56.534    c-23.791,13.894-49.771,20.834-77.945,20.834c-28.167,0-54.149-6.94-77.943-20.834c-23.791-13.901-42.633-32.743-56.527-56.534    c-13.897-23.791-20.843-49.772-20.843-77.941c0-28.171,6.949-54.152,20.843-77.943c13.891-23.791,32.738-42.637,56.527-56.53    c23.791-13.895,49.772-20.84,77.943-20.84c28.173,0,54.154,6.945,77.945,20.84c23.791,13.894,42.634,32.739,56.527,56.53    c13.895,23.791,20.838,49.772,20.838,77.943C374.58,247.436,367.637,273.417,353.742,297.208z" data-original="#000000" class="active-path" data-old_color="#000000" fill="#0782D0"/>
              <path d="M225.836,112.204c-2.098-1.711-4.281-2.57-6.566-2.57c-2.284,0-4.474,0.859-6.567,2.57l-91.076,91.076    c-1.905,2.281-2.854,4.57-2.854,6.851c0,2.666,0.855,4.853,2.57,6.567c1.713,1.713,3.903,2.568,6.567,2.568h54.816v100.5    c0,2.666,0.855,4.856,2.57,6.563c1.712,1.711,3.903,2.567,6.567,2.567h54.82c2.662,0,4.853-0.856,6.561-2.567    c1.711-1.707,2.573-3.897,2.573-6.563v-100.5h54.815c4.189,0,7.04-1.903,8.562-5.712c1.523-3.614,0.862-6.945-1.998-9.991    L225.836,112.204z" data-original="#000000" class="active-path" data-old_color="#000000" fill="#0782D0"/>
            </g>
          </g></g> </svg>
        <br>
        <span style="color: #686868; font-weight: 600; font-size: 14px;">Drag and drop your file here :)</span>
      </div>
      <!--Si no muestra el nombre del archivo ingresado-->
      <ng-template #empty  class="else">
        <div class="else">
          <span style="color: #686868; font-weight: 600; font-size: 14px;">{{FileNamePicking}}</span>
        </div>
      </ng-template>
      <!-------------------------------------------------------------------->

    </ng-template>


  </ngx-file-drop>
</div>

<br>
<!--------- Parámetros de ejecución ---------->
<!--Título-->
<div class="title">
    <span class="title_text">Execution Parameters</span>
    <img class="clock-d" src="./assets/circular-alarm.svg">
  </div>
  <!--Sección-->
  <div class="card data">
    <div class="card-body">
      <div class="row s1">
  
        <label for="Name" class="data-title col-xs-3">
          LIMIT TIME
          <svg class="sgv-clock" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            viewBox="0 0 510 510" style="enable-background:new 0 0 510 510;" xml:space="preserve">
            <g>
              <g id="access-time">
                <path style="fill-opacity:0.9;" d="M255,0C114.75,0,0,114.75,0,255s114.75,255,255,255s255-114.75,255-255S395.25,0,255,0z
                  M255,459c-112.2,0-204-91.8-204-204S142.8,51,255,51s204,91.8,204,204S367.2,459,255,459z"/>
                <polygon style="fill-opacity:0.9;" points="267.75,127.5 229.5,127.5 229.5,280.5 362.1,362.1 382.5,328.95 267.75,260.1 		"/>
              </g>
            </g>
          </svg>
        </label>
        
        <span style="font-size: 15px;font-weight: bold;margin-top: 7px;">--></span>
        <input [(ngModel)]="tmlimitPicking" type="number" min=1 class="form-control i2 col-xs-3" placeholder="Limit Time (seg)">
        
        <ng-template #popTitle> <div style="text-align: center;"> <strong>ERROR MESSAGE</strong> <img class="checked" height="5px" src="./assets/error.svg"> </div> </ng-template>
        <ng-template #popContent> <div style="text-align: center;"> Problems sending file.<br>Review data or limit time. </div></ng-template>
  
        <button class="btn btn-primary bd col-xs-3" (click)='sendDataPicking(tmlimitPicking)'
        [ngbPopover]="popContent" [popoverTitle]="popTitle" [disablePopover]="disablePopover"
        placement="right">SEND DATA</button>
  
      </div>
    </div>
  </div>
  <!---------------------------------------------->







<!---------------------------------Error en el servicio-------------------------------------->
<div *ngIf="errorService === true">
  <br>
  <br>
  <p *ngFor="let alert of alerts">
    <ngb-alert [type]="alert.type" (close)="close(alert)" class="error">
        <div style="color: black; text-align: center; font-size: 18px;">
          <strong>SERVICE ERROR</strong>
          <img class="error-service" src="./assets/cancel.svg">
        </div>
        <div style="color: black; text-align:justify; font-size: 14px;">
          <span>There are problems with the service. It is possible that the error is presented by one of the following four options:</span>
          <br>
          <span>1. Connection problems with the server. Check the connection.</span>
          <br>
          <span>2. Problems with the excel data file. Check that the data is according to the template presented.</span>
          <br>
          <span>3. Data infeasibility. Make sure the assignment is not impossible due to capacity issues.</span>
          <br>
          <span>4. Limit execution time. The execution time may not be enough for an answer to be found.</span>
        </div>
      </ngb-alert>
  </p>
</div>
<!----------------------------------------------------------------------------------------------->


<!------------------------------------------ Tabla de resultados ---------------------------------------------------->
<div *ngIf="errorService === false">
  <br>
  <br>
  <div class="pag-section" *ngIf="receivedRuta && receivedRuta.distanciaTotal !== 0">
    <div class="card results">
  
        <div class="card-header rh" style="color: black; text-align: center; font-size: 18px;">
          <span ><strong>RESULTS PANEL</strong></span> 
          <img class="checked" src="./assets/checked_green.svg">
        </div>
      
        <div class="card-body">
          <div >
            <table class="table" aria-describedby="mydesc">
              <thead>
                <tr>
                  <th scope="col" colspan="4">PICKING SOLUTION</th>
                </tr>
                <tr>
                  <th scope="col" colspan="4">Total distance traveled: {{receivedRuta.distanciaTotal}}</th>
                </tr>
              </thead>
        
              <tbody *ngFor="let r of receivedRuta.ruta | paginate: {itemsPerPage: itemsPorPagina, currentPage: pageActual}; let i = index">
          
                <!-- Número de Ruta -->
                <tr>
                  <th scope="col" colspan="4">Route {{receivedRuta.ruta[pageActual-1].id}}</th>
                </tr>
          
                <!-- Distancia Recorrida -->
                <tr>
                  <td colspan="4">Traveled distance: {{receivedRuta.ruta[pageActual-1].distanciaRuta}}</td>
                </tr>
            
                <!-- Recorrido -->
                <tr *ngFor="let x of receivedRuta.ruta[pageActual-1].recorrido">
                  <td>From rack</td>
                  <td>{{x[0]}}</td>
                  <td>to the rack</td>
                  <td>{{x[1]}}</td>
                </tr>
          
              </tbody>
        
            </table>  
          </div>
              
          <div class="pag-section">
            <pagination-controls previousLabel="Previous" nextLabel="Next" (pageChange)="pageActual = $event" 
            class="paginator"></pagination-controls>
          </div>
        </div>
      
      </div>
  </div>
</div>



<br>
<!--Atributos PopOver-->
<ng-template #popTitleDown> <div style="text-align: center;"> <strong>ERROR MESSAGE</strong> <img class="checked" height="5px" src="./assets/error.svg"> </div> </ng-template>
<ng-template #popContentDown> <div style="text-align: center; display: flex;">The results cannot be downloaded. The file is not available.</div></ng-template>

<div style="text-align: center;">
  <button class="btn btn-primary" (click)=downloadFilePicking() id="button-download"
  [ngbPopover]="popContentDown" [popoverTitle]="popTitleDown" [disablePopover]="disablePopoverDown"
  placement="right">DOWNLOAD FILE SOLUTION</button>
</div>

<br>
<br>


<!----------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------->